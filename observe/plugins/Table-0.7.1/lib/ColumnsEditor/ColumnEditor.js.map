{"version":3,"sources":["../../../src/ColumnsEditor/ColumnEditor.tsx"],"sourcesContent":["// Copyright 2024 The Perses Authors\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Button, ButtonGroup, StackProps, Switch, TextField } from '@mui/material';\nimport { ReactElement, useState } from 'react';\nimport {\n  AlignSelector,\n  FormatControls,\n  OptionsEditorColumn,\n  OptionsEditorControl,\n  OptionsEditorGrid,\n  OptionsEditorGroup,\n  SortSelectorButtons,\n} from '@perses-dev/components';\nimport { FormatOptions } from '@perses-dev/core';\nimport { PluginKindSelect } from '@perses-dev/plugin-system';\nimport { ColumnSettings } from '../table-model';\n\nconst DEFAULT_FORMAT: FormatOptions = {\n  unit: 'decimal',\n  shortValues: true,\n};\n\ntype OmittedMuiProps = 'children' | 'value' | 'onChange';\n\nexport interface ColumnEditorProps extends Omit<StackProps, OmittedMuiProps> {\n  column: ColumnSettings;\n  onChange: (column: ColumnSettings) => void;\n}\n\nexport function ColumnEditor({ column, onChange, ...others }: ColumnEditorProps): ReactElement {\n  const [width, setWidth] = useState<number>(\n    column.width === undefined || column.width === 'auto' ? 100 : column.width\n  );\n\n  return (\n    <OptionsEditorGrid {...others}>\n      <OptionsEditorColumn>\n        <OptionsEditorGroup title=\"Column\">\n          <OptionsEditorControl\n            label=\"Name*\"\n            control={\n              <TextField value={column.name} onChange={(e) => onChange({ ...column, name: e.target.value })} required />\n            }\n          />\n          <OptionsEditorControl\n            label=\"Header\"\n            control={\n              <TextField\n                value={column.header ?? ''}\n                onChange={(e) => onChange({ ...column, header: e.target.value ? e.target.value : undefined })}\n              />\n            }\n          />\n          <OptionsEditorControl\n            label=\"Header Tooltip\"\n            control={\n              <TextField\n                value={column.headerDescription ?? ''}\n                onChange={(e) =>\n                  onChange({ ...column, headerDescription: e.target.value ? e.target.value : undefined })\n                }\n              />\n            }\n          />\n          <OptionsEditorControl\n            label=\"Cell Tooltip\"\n            control={\n              <TextField\n                value={column.cellDescription ?? ''}\n                onChange={(e) => onChange({ ...column, cellDescription: e.target.value ? e.target.value : undefined })}\n              />\n            }\n          />\n          <OptionsEditorControl\n            label=\"Enable sorting\"\n            control={\n              <Switch\n                checked={column.enableSorting ?? false}\n                onChange={(e) => onChange({ ...column, enableSorting: e.target.checked })}\n              />\n            }\n          />\n          {column.enableSorting && (\n            <OptionsEditorControl\n              label=\"Default Sort\"\n              control={\n                <SortSelectorButtons\n                  size=\"medium\"\n                  value={column.sort}\n                  sx={{\n                    margin: 0.5,\n                  }}\n                  onChange={(sort) => onChange({ ...column, sort: sort })}\n                />\n              }\n            />\n          )}\n        </OptionsEditorGroup>\n      </OptionsEditorColumn>\n\n      <OptionsEditorColumn>\n        <OptionsEditorGroup title=\"Visual\">\n          <OptionsEditorControl\n            label=\"Show column\"\n            control={\n              <Switch\n                checked={!(column.hide ?? false)}\n                onChange={(e) => onChange({ ...column, hide: !e.target.checked })}\n              />\n            }\n          />\n          <OptionsEditorControl\n            label=\"Display\"\n            control={\n              <ButtonGroup aria-label=\"Display\" size=\"small\">\n                <Button\n                  variant={!column.plugin ? 'contained' : 'outlined'}\n                  onClick={() => onChange({ ...column, plugin: undefined })}\n                >\n                  Text\n                </Button>\n                <Button\n                  variant={column.plugin ? 'contained' : 'outlined'}\n                  onClick={() => onChange({ ...column, plugin: { kind: 'StatChart', spec: {} } })}\n                >\n                  Embedded Panel\n                </Button>\n              </ButtonGroup>\n            }\n          />\n          {column.plugin ? (\n            <OptionsEditorControl\n              label=\"Panel Type\"\n              control={\n                <PluginKindSelect\n                  pluginTypes={['Panel']}\n                  value={{ type: 'Panel', kind: column.plugin.kind }}\n                  onChange={(event) => onChange({ ...column, plugin: { kind: event.kind, spec: {} } })}\n                />\n              }\n            />\n          ) : (\n            <FormatControls\n              value={column.format ?? DEFAULT_FORMAT}\n              onChange={(newFormat): void =>\n                onChange({\n                  ...column,\n                  format: newFormat,\n                })\n              }\n            />\n          )}\n          <OptionsEditorControl\n            label=\"Alignment\"\n            control={\n              <AlignSelector\n                size=\"small\"\n                value={column.align ?? 'left'}\n                onChange={(align) => onChange({ ...column, align: align })}\n              />\n            }\n          />\n          <OptionsEditorControl\n            label=\"Custom width\"\n            control={\n              <Switch\n                checked={column.width !== undefined && column.width !== 'auto'}\n                onChange={(e) => onChange({ ...column, width: e.target.checked ? width : 'auto' })}\n              />\n            }\n          />\n          {column.width !== undefined && column.width !== 'auto' && (\n            <OptionsEditorControl\n              label=\"Width\"\n              control={\n                <TextField\n                  type=\"number\"\n                  value={width}\n                  slotProps={{ htmlInput: { min: 1 } }}\n                  onChange={(e) => {\n                    setWidth(+e.target.value);\n                    onChange({ ...column, width: +e.target.value });\n                  }}\n                />\n              }\n            />\n          )}\n        </OptionsEditorGroup>\n      </OptionsEditorColumn>\n    </OptionsEditorGrid>\n  );\n}\n"],"names":["Button","ButtonGroup","Switch","TextField","useState","AlignSelector","FormatControls","OptionsEditorColumn","OptionsEditorControl","OptionsEditorGrid","OptionsEditorGroup","SortSelectorButtons","PluginKindSelect","DEFAULT_FORMAT","unit","shortValues","ColumnEditor","column","onChange","others","width","setWidth","undefined","title","label","control","value","name","e","target","required","header","headerDescription","cellDescription","checked","enableSorting","size","sort","sx","margin","hide","aria-label","variant","plugin","onClick","kind","spec","pluginTypes","type","event","format","newFormat","align","slotProps","htmlInput","min"],"mappings":"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"}