"use strict";(self.webpackChunkPrometheus=self.webpackChunkPrometheus||[]).push([["6925"],{74081:function(e,a,l){a.default=void 0;var r,t=(r=l(30265))&&r.__esModule?r:{default:r};a.default=(0,t.default)("M9,3V4H4V6H5V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,19V6H20V4H15V3H9M9,8H11V17H9V8M13,8H15V17H13V8Z","TrashCan")},96114:function(e,a,l){l.r(a),l.d(a,{PrometheusLabelValuesVariable:()=>n});var r=l(58891),t=l(87629),s=l(90726);let n={getVariableOptions:async(e,a)=>{let l=await a.datasourceStore.getDatasourceClient(e.datasource??t.Mm),n=e.matchers?e.matchers.map(e=>(0,r.replaceVariables)(e,a.variables)):void 0,o=(0,t.Bf)(a.timeRange),{data:u}=await l.labelValues({labelName:(0,r.replaceVariables)(e.labelName,a.variables),"match[]":n,...o});return{data:(0,s.LY)(u)}},dependsOn:e=>{var a;return{variables:(null===(a=e.matchers)||void 0===a?void 0:a.map(e=>(0,r.parseVariables)(e)).flat().concat((0,r.parseVariables)(e.labelName)))||[]}},OptionsEditorComponent:s.xA,createInitialOptions:()=>({labelName:""})}},90726:function(e,a,l){l.d(a,{gB:()=>y,LY:()=>C,g3:()=>x,ik:()=>j,xA:()=>g,qT:()=>f});var r=l(24246),t=l(25283),s=l(90192),n=l(68808),o=l(8695),u=l(58891),d=l(75586),i=l(82901),c=l(87629),h=l(36372),m=l(75094),v=l(48565),b=l(74081);function p(e){let{matchers:a,onChange:l,isReadonly:s}=e;return(0,r.jsxs)(t.Z,{spacing:1,mb:2,children:[a.map((e,t)=>(0,r.jsxs)(h.Z,{display:"flex",children:[(0,r.jsx)(o.Z,{fullWidth:!0,label:"Series Selector",value:e,InputProps:{readOnly:s},onChange:e=>{l((0,d.Uy)(a,a=>{a[t]=e.target.value}))}}),(0,r.jsx)(m.Z,{onClick:()=>{l((0,d.Uy)(a,e=>{e.splice(t,1)}))},disabled:s,children:(0,r.jsx)(b.default,{})})]},t)),(0,r.jsx)(h.Z,{children:(0,r.jsx)(v.Z,{fullWidth:!1,color:"secondary",variant:"outlined",onClick:()=>{l((0,d.Uy)(a,e=>{e.push("")}))},disabled:s,children:"Add Series Selector"})})]})}function g(e){let{onChange:a,value:l}=e,{datasource:i}=l,h=i??c.Mm;return(0,r.jsxs)(t.Z,{spacing:2,children:[(0,r.jsxs)(s.Z,{margin:"dense",children:[(0,r.jsx)(n.Z,{id:"prom-datasource-label",children:"Prometheus Datasource"}),(0,r.jsx)(u.DatasourceSelect,{datasourcePluginKind:"PrometheusDatasource",value:h,onChange:e=>{if((0,c.sv)(e)){a((0,d.Uy)(l,a=>{a.datasource=(0,c.Rv)(e)?void 0:e}));return}throw Error("Got unexpected non-Prometheus datasource selector")},readOnly:e.isReadonly,labelId:"prom-datasource-label",label:"Prometheus Datasource"})]}),(0,r.jsx)(o.Z,{label:"Label Name",required:!0,value:e.value.labelName,onChange:a=>{e.onChange({...e.value,labelName:a.target.value})},InputProps:{readOnly:e.isReadonly}}),(0,r.jsx)(p,{matchers:e.value.matchers??[],onChange:a=>{e.onChange({...e.value,matchers:a})},isReadonly:e.isReadonly})]})}function x(e){let{onChange:a,value:l}=e,{datasource:o}=l,i=o??c.Mm;return(0,r.jsxs)(t.Z,{spacing:2,children:[(0,r.jsxs)(s.Z,{margin:"dense",children:[(0,r.jsx)(n.Z,{id:"prom-datasource-label",children:"Prometheus Datasource"}),(0,r.jsx)(u.DatasourceSelect,{datasourcePluginKind:"PrometheusDatasource",value:i,onChange:e=>{if((0,c.sv)(e)){a((0,d.Uy)(l,a=>{a.datasource=(0,c.Rv)(e)?void 0:e}));return}throw Error("Got unexpected non-Prometheus datasource selector")},disabled:e.isReadonly,labelId:"prom-datasource-label",label:"Prometheus Datasource"})]}),(0,r.jsx)(p,{matchers:e.value.matchers??[],isReadonly:e.isReadonly,onChange:a=>{e.onChange({...e.value,matchers:a})}})]})}function f(e){let{onChange:a,value:l}=e,{datasource:h}=l,m=h??c.Mm,{data:v}=(0,u.useDatasourceClient)(m),b=null==v?void 0:v.options.datasourceUrl;return(0,r.jsxs)(t.Z,{spacing:2,children:[(0,r.jsxs)(s.Z,{margin:"dense",children:[(0,r.jsx)(n.Z,{id:"prom-datasource-label",children:"Prometheus Datasource"}),(0,r.jsx)(u.DatasourceSelect,{datasourcePluginKind:c.nY,value:m,onChange:e=>{if((0,c.sv)(e)){a((0,d.Uy)(l,a=>{a.datasource=(0,c.Rv)(e)?void 0:e}));return}throw Error("Got unexpected non-Prometheus datasource selector")},labelId:"prom-datasource-label",label:"Prometheus Datasource",disabled:e.isReadonly})]}),(0,r.jsx)(i.P,{completeConfig:{remote:{url:b}},value:l.expr,datasource:m,onBlur:a=>{e.onChange({...e.value,expr:a.target.textContent??""})},readOnly:e.isReadonly,width:"100%"}),(0,r.jsx)(o.Z,{label:"Label Name",value:e.value.labelName,InputProps:{readOnly:e.isReadonly},onChange:a=>{e.onChange({...e.value,labelName:a.target.value})}})]})}function y(e,a){let l=new Set;for(let r of e.result){let e=r.metric[a];void 0!==e&&l.add(e)}return Array.from(l.values())}function j(e,a){let l=new Set;for(let r of e.result){let e=r.metric[a];void 0!==e&&l.add(e)}return Array.from(l.values())}let C=e=>e?e.map(e=>({value:e,label:e})):[]}}]);