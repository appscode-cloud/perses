"use strict";(self.webpackChunkPrometheus=self.webpackChunkPrometheus||[]).push([["5345"],{82901:function(e,r,a){a.d(r,{P:()=>ey});var t,n,i,s,o,c=a(24246),l=a(46359),d=a(51217),p=a(69485),u=a(94776),m=a(25283),v=a(68808),g=a(32964),y=a(75094),x=a(50898),h=a(96402),T=a(54538),j=a(72629),_=a(10763),f=a(58891),b=a(6421),$=a(91909),w=a(36372),E=a(52054),Z=a(71852),S=a(2259),k=a(20791),L=a(78277),F=((t={}).aggregation="aggregation",t.binaryExpr="binaryExpr",t.call="call",t.matrixSelector="matrixSelector",t.subquery="subquery",t.numberLiteral="numberLiteral",t.parenExpr="parenExpr",t.stringLiteral="stringLiteral",t.unaryExpr="unaryExpr",t.vectorSelector="vectorSelector",t.placeholder="placeholder",t),q=((n={}).add="+",n.sub="-",n.mul="*",n.div="/",n.mod="%",n.pow="^",n.eql="==",n.neq="!=",n.gtr=">",n.lss="<",n.gte=">=",n.lte="<=",n.and="and",n.or="or",n.unless="unless",n.atan2="atan2",n),C=((i={}).oneToOne="one-to-one",i.manyToOne="many-to-one",i.oneToMany="one-to-many",i.manyToMany="many-to-many",i),P=((s={}).none="none",s.vector="vector",s.scalar="scalar",s.matrix="matrix",s.string="string",s),I=((o={}).equal="=",o.notEqual="!=",o.matchRegexp="=~",o.matchNotRegexp="!~",o);let O={[q.add]:3,[q.sub]:3,[q.mul]:2,[q.div]:2,[q.mod]:2,[q.pow]:1,[q.eql]:4,[q.neq]:4,[q.gtr]:4,[q.lss]:4,[q.gte]:4,[q.lte]:4,[q.and]:5,[q.or]:6,[q.unless]:5,[q.atan2]:2},R=(e,r)=>r.type!==F.binaryExpr||O[e]>O[r.op]?r:{type:F.parenExpr,expr:r},U=e=>{switch(e.type){case F.aggregation:return null===e.param?[e.expr]:[e.param,e.expr];case F.subquery:case F.parenExpr:return[e.expr];case F.call:return e.args;case F.matrixSelector:case F.vectorSelector:case F.numberLiteral:case F.stringLiteral:return[];case F.placeholder:return e.children;case F.unaryExpr:return[e.expr];case F.binaryExpr:return[e.lhs,e.rhs];default:throw Error("unsupported node type")}},M=["topk","bottomk","quantile","count_values","limitk","limit_ratio"],K=e=>e.replace(/([\\"])/g,"\\$1");var B=a(12709),N=a(29085);let V=(0,B.ZP)("span")(()=>({fontFamily:'"DejaVu Sans Mono", monospace'})),z=(0,B.ZP)("span")(e=>{let{theme:r}=e;return{color:"dark"===r.palette.mode?"#e5c07b":"#708"}}),Q=(0,B.ZP)("span")(e=>{let{theme:r}=e;return{color:"dark"===r.palette.mode?"#61afef":"#2a2e42"}}),D=(0,B.ZP)("span")(e=>{let{theme:r}=e;return{color:"dark"===r.palette.mode?"#e06c75":"#2a2e42"}}),Y=(0,B.ZP)("span")(e=>{let{theme:r}=e;return{color:"dark"===r.palette.mode?"#61afef":"#219"}}),A=(0,B.ZP)("span")(e=>{let{theme:r}=e;return{color:"dark"===r.palette.mode?"#98c379":"#a31515"}}),G=(0,B.ZP)("span")(()=>({color:"#aaaaaa"})),W=(0,B.ZP)("span")(e=>{let{theme:r}=e;return{color:"dark"===r.palette.mode?"#e5c07b":"#09885a"}}),X=(0,B.ZP)("span")(e=>{let{theme:r}=e;return{color:"dark"===r.palette.mode?"#e5c07b":"#164"}}),J=(0,B.ZP)("span")(e=>{let{theme:r}=e;return{color:"dark"===r.palette.mode?"#56b6c2":"#708"}}),H=e=>e.map((e,r)=>(0,c.jsxs)("span",{children:[0!==r&&", ",(0,c.jsx)(Y,{children:e})]},r)),ee=(e,r,a)=>(0,c.jsxs)(c.Fragment,{children:[null!==e?(0,c.jsxs)(c.Fragment,{children:[" ",(0,c.jsx)(J,{children:"@"})," ",(0,c.jsx)(X,{children:(e/1e3).toFixed(3)})]}):null!==r?(0,c.jsxs)(c.Fragment,{children:[" ",(0,c.jsx)(J,{children:"@"})," ",(0,c.jsx)(z,{children:r}),(0,c.jsx)("span",{children:"("}),(0,c.jsx)("span",{children:")"})]}):(0,c.jsx)(c.Fragment,{}),0===a?(0,c.jsx)(c.Fragment,{}):a>0?(0,c.jsxs)(c.Fragment,{children:[" ",(0,c.jsx)(z,{children:"offset"})," ",(0,c.jsx)(W,{children:(0,N.LU)((0,N.oK)(a))})]}):(0,c.jsxs)(c.Fragment,{children:[" ",(0,c.jsx)(z,{children:"offset"})," ",(0,c.jsxs)(W,{children:["-",(0,N.LU)((0,N.oK)(-a))]})]})]}),er=e=>{let r=e.matchers.filter(r=>"__name__"!==r.name||r.type!==I.equal||r.value!==e.name).map((e,r)=>(0,c.jsxs)("span",{children:[0!==r&&",",(0,c.jsx)(Y,{children:e.name}),e.type,(0,c.jsxs)(A,{children:['"',K(e.value),'"']})]},r));return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(D,{children:e.name}),r.length>0&&(0,c.jsxs)(c.Fragment,{children:["{",(0,c.jsx)("span",{children:r}),"}"]}),e.type===F.matrixSelector&&(0,c.jsxs)(c.Fragment,{children:["[",(0,c.jsx)(W,{children:(0,N.LU)((0,N.oK)(e.range))}),"]"]}),ee(e.timestamp,e.startOrEnd,e.offset)]})},ea=(0,c.jsx)(G,{children:"…"}),et=(e,r,a)=>{if(0===a)return ea;let t=void 0===a?void 0:a-1;switch(e.type){case F.aggregation:return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(J,{children:e.op}),e.without?(0,c.jsxs)(c.Fragment,{children:[" ",(0,c.jsx)(z,{children:"without"}),(0,c.jsx)("span",{children:"("}),H(e.grouping),(0,c.jsx)("span",{children:")"})," "]}):e.grouping.length>0&&(0,c.jsxs)(c.Fragment,{children:[" ",(0,c.jsx)(z,{children:"by"}),(0,c.jsx)("span",{children:"("}),H(e.grouping),(0,c.jsx)("span",{children:")"})," "]}),r&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{children:"("}),null!==e.param&&(0,c.jsxs)(c.Fragment,{children:[en(e.param,r,t),", "]}),en(e.expr,r,t),(0,c.jsx)("span",{children:")"})]})]});case F.subquery:return(0,c.jsxs)(c.Fragment,{children:[r&&en(e.expr,r,t),"[",(0,c.jsx)(W,{children:(0,N.LU)((0,N.oK)(e.range))}),":",0!==e.step&&(0,c.jsx)(W,{children:(0,N.LU)((0,N.oK)(e.step))}),"]",ee(e.timestamp,e.startOrEnd,e.offset)]});case F.parenExpr:return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{children:"("}),r&&en(e.expr,r,t),(0,c.jsx)("span",{children:")"})]});case F.call:{let a=void 0===t||t>0?e.args.map((e,a)=>(0,c.jsxs)("span",{children:[0!==a&&", ",en(e,r)]},a)):e.args.length>0?ea:"";return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Q,{children:e.func.name}),r&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{children:"("}),a,(0,c.jsx)("span",{children:")"})]})]})}case F.matrixSelector:case F.vectorSelector:return er(e);case F.numberLiteral:return(0,c.jsx)(X,{children:e.val});case F.stringLiteral:return(0,c.jsxs)(A,{children:['"',K(e.val),'"']});case F.unaryExpr:return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(J,{children:e.op}),r&&en(e.expr,r,t)]});case F.binaryExpr:{let a=(0,c.jsx)(c.Fragment,{}),n=(0,c.jsx)(c.Fragment,{}),i=e.matching;return null!==i&&(i.labels.length>0||i.on)&&(a=i.on?(0,c.jsxs)(c.Fragment,{children:[" ",(0,c.jsx)(z,{children:"on"}),(0,c.jsx)("span",{children:"("}),H(i.labels),(0,c.jsx)("span",{children:")"})]}):(0,c.jsxs)(c.Fragment,{children:[" ",(0,c.jsx)(z,{children:"ignoring"}),(0,c.jsx)("span",{children:"("}),H(i.labels),(0,c.jsx)("span",{children:")"})]}),(i.card===C.manyToOne||i.card===C.oneToMany)&&(n=(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(z,{children:[" ","group_",i.card===C.manyToOne?"left":"right"]}),(0,c.jsx)("span",{children:"("}),H(i.include),(0,c.jsx)("span",{children:")"})]}))),(0,c.jsxs)(c.Fragment,{children:[r&&en(R(e.op,e.lhs),r,t)," ",(["atan2","and","or","unless"].includes(e.op),(0,c.jsx)(J,{children:e.op})),e.bool&&(0,c.jsxs)(c.Fragment,{children:[" ",(0,c.jsx)(z,{children:"bool"})]}),a,n," ",r&&en(R(e.op,e.rhs),r,t)]})}case F.placeholder:return ea;default:throw Error("unsupported node type")}},en=(e,r,a)=>(0,c.jsx)(V,{children:et(e,r,a)}),ei=(e,r,a)=>`${null!==e?` @ ${(e/1e3).toFixed(3)}`:null!==r?` @ ${r}()`:""}${0===a?"":a>0?` offset ${(0,N.LU)((0,N.oK)(a))}`:` offset -${(0,N.LU)((0,N.oK)(-a))}`}`,es=e=>{let r=e.matchers.filter(r=>"__name__"!==r.name||r.type!==I.equal||r.value!==e.name).map(e=>`${e.name}${e.type}"${K(e.value)}"`),a=e.type===F.matrixSelector?`[${(0,N.LU)((0,N.oK)(e.range))}]`:"",t=ei(e.timestamp,e.startOrEnd,e.offset);return`${e.name}${r.length>0?`{${r.join(",")}}`:""}${a}${t}`},eo=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],t=!(arguments.length>3)||void 0===arguments[3]||arguments[3],n=a?"\n":"",i=a?"\n":" ",s=r+2,o=a?" ".repeat(r):"",c=t?o:"";switch(e.type){case F.aggregation:return`${c}${e.op}${e.without?` without(${e.grouping.join(", ")}) `:e.grouping.length>0?` by(${e.grouping.join(", ")}) `:""}(${n}${M.includes(e.op)&&null!==e.param?`${eo(e.param,s,a)},${i}`:""}${eo(e.expr,s,a)}${n}${o})`;case F.subquery:return`${c}${eo(e.expr,r,a)}[${(0,N.LU)((0,N.oK)(e.range))}:${0!==e.step?(0,N.LU)((0,N.oK)(e.step)):""}]${ei(e.timestamp,e.startOrEnd,e.offset)}`;case F.parenExpr:return`${c}(${n}${eo(e.expr,s,a)}${n}${o})`;case F.call:{let r=e.args.length>0?n:"";return`${c}${e.func.name}(${r}${e.args.map(e=>eo(e,s,a)).join(","+i)}${r}${e.args.length>0?o:""})`}case F.matrixSelector:case F.vectorSelector:return`${c}${es(e)}`;case F.numberLiteral:return`${c}${e.val}`;case F.stringLiteral:return`${c}"${K(e.val)}"`;case F.unaryExpr:return`${c}${e.op}${eo(e.expr,r,a,!1)}`;case F.binaryExpr:{let r="",t="",n=e.matching;return null!==n&&(n.labels.length>0||n.on)&&(r=n.on?` on(${n.labels.join(", ")})`:` ignoring(${n.labels.join(", ")})`,(n.card===C.manyToOne||n.card===C.oneToMany)&&(t=` group_${n.card===C.manyToOne?"left":"right"}(${n.include.join(",")})`)),`${eo(R(e.op,e.lhs),s,a)}${i}${o}${e.op}${e.bool?" bool":""}${r}${t}${i}${eo(R(e.op,e.rhs),s,a)}`}case F.placeholder:return`${c}…${e.children.length>0?`(${n}${e.children.map(e=>eo(e,s,a)).join(","+i)}${n}${o})`:""}`;default:throw Error("unsupported node type")}},ec={abs:{name:"abs",argTypes:[P.vector],variadic:0,returnType:P.vector},absent:{name:"absent",argTypes:[P.vector],variadic:0,returnType:P.vector},absent_over_time:{name:"absent_over_time",argTypes:[P.matrix],variadic:0,returnType:P.vector},acos:{name:"acos",argTypes:[P.vector],variadic:0,returnType:P.vector},acosh:{name:"acosh",argTypes:[P.vector],variadic:0,returnType:P.vector},asin:{name:"asin",argTypes:[P.vector],variadic:0,returnType:P.vector},asinh:{name:"asinh",argTypes:[P.vector],variadic:0,returnType:P.vector},atan:{name:"atan",argTypes:[P.vector],variadic:0,returnType:P.vector},atanh:{name:"atanh",argTypes:[P.vector],variadic:0,returnType:P.vector},avg_over_time:{name:"avg_over_time",argTypes:[P.matrix],variadic:0,returnType:P.vector},ceil:{name:"ceil",argTypes:[P.vector],variadic:0,returnType:P.vector},changes:{name:"changes",argTypes:[P.matrix],variadic:0,returnType:P.vector},clamp:{name:"clamp",argTypes:[P.vector,P.scalar,P.scalar],variadic:0,returnType:P.vector},clamp_max:{name:"clamp_max",argTypes:[P.vector,P.scalar],variadic:0,returnType:P.vector},clamp_min:{name:"clamp_min",argTypes:[P.vector,P.scalar],variadic:0,returnType:P.vector},cos:{name:"cos",argTypes:[P.vector],variadic:0,returnType:P.vector},cosh:{name:"cosh",argTypes:[P.vector],variadic:0,returnType:P.vector},count_over_time:{name:"count_over_time",argTypes:[P.matrix],variadic:0,returnType:P.vector},day_of_month:{name:"day_of_month",argTypes:[P.vector],variadic:1,returnType:P.vector},day_of_week:{name:"day_of_week",argTypes:[P.vector],variadic:1,returnType:P.vector},day_of_year:{name:"day_of_year",argTypes:[P.vector],variadic:1,returnType:P.vector},days_in_month:{name:"days_in_month",argTypes:[P.vector],variadic:1,returnType:P.vector},deg:{name:"deg",argTypes:[P.vector],variadic:0,returnType:P.vector},delta:{name:"delta",argTypes:[P.matrix],variadic:0,returnType:P.vector},deriv:{name:"deriv",argTypes:[P.matrix],variadic:0,returnType:P.vector},exp:{name:"exp",argTypes:[P.vector],variadic:0,returnType:P.vector},floor:{name:"floor",argTypes:[P.vector],variadic:0,returnType:P.vector},histogram_avg:{name:"histogram_avg",argTypes:[P.vector],variadic:0,returnType:P.vector},histogram_count:{name:"histogram_count",argTypes:[P.vector],variadic:0,returnType:P.vector},histogram_fraction:{name:"histogram_fraction",argTypes:[P.scalar,P.scalar,P.vector],variadic:0,returnType:P.vector},histogram_quantile:{name:"histogram_quantile",argTypes:[P.scalar,P.vector],variadic:0,returnType:P.vector},histogram_stddev:{name:"histogram_stddev",argTypes:[P.vector],variadic:0,returnType:P.vector},histogram_stdvar:{name:"histogram_stdvar",argTypes:[P.vector],variadic:0,returnType:P.vector},histogram_sum:{name:"histogram_sum",argTypes:[P.vector],variadic:0,returnType:P.vector},double_exponential_smoothing:{name:"double_exponential_smoothing",argTypes:[P.matrix,P.scalar,P.scalar],variadic:0,returnType:P.vector},hour:{name:"hour",argTypes:[P.vector],variadic:1,returnType:P.vector},idelta:{name:"idelta",argTypes:[P.matrix],variadic:0,returnType:P.vector},increase:{name:"increase",argTypes:[P.matrix],variadic:0,returnType:P.vector},irate:{name:"irate",argTypes:[P.matrix],variadic:0,returnType:P.vector},label_join:{name:"label_join",argTypes:[P.vector,P.string,P.string,P.string],variadic:-1,returnType:P.vector},label_replace:{name:"label_replace",argTypes:[P.vector,P.string,P.string,P.string,P.string],variadic:0,returnType:P.vector},last_over_time:{name:"last_over_time",argTypes:[P.matrix],variadic:0,returnType:P.vector},ln:{name:"ln",argTypes:[P.vector],variadic:0,returnType:P.vector},log10:{name:"log10",argTypes:[P.vector],variadic:0,returnType:P.vector},log2:{name:"log2",argTypes:[P.vector],variadic:0,returnType:P.vector},mad_over_time:{name:"mad_over_time",argTypes:[P.matrix],variadic:0,returnType:P.vector},max_over_time:{name:"max_over_time",argTypes:[P.matrix],variadic:0,returnType:P.vector},min_over_time:{name:"min_over_time",argTypes:[P.matrix],variadic:0,returnType:P.vector},minute:{name:"minute",argTypes:[P.vector],variadic:1,returnType:P.vector},month:{name:"month",argTypes:[P.vector],variadic:1,returnType:P.vector},pi:{name:"pi",argTypes:[],variadic:0,returnType:P.scalar},predict_linear:{name:"predict_linear",argTypes:[P.matrix,P.scalar],variadic:0,returnType:P.vector},present_over_time:{name:"present_over_time",argTypes:[P.matrix],variadic:0,returnType:P.vector},quantile_over_time:{name:"quantile_over_time",argTypes:[P.scalar,P.matrix],variadic:0,returnType:P.vector},rad:{name:"rad",argTypes:[P.vector],variadic:0,returnType:P.vector},rate:{name:"rate",argTypes:[P.matrix],variadic:0,returnType:P.vector},resets:{name:"resets",argTypes:[P.matrix],variadic:0,returnType:P.vector},round:{name:"round",argTypes:[P.vector,P.scalar],variadic:1,returnType:P.vector},scalar:{name:"scalar",argTypes:[P.vector],variadic:0,returnType:P.scalar},sgn:{name:"sgn",argTypes:[P.vector],variadic:0,returnType:P.vector},sin:{name:"sin",argTypes:[P.vector],variadic:0,returnType:P.vector},sinh:{name:"sinh",argTypes:[P.vector],variadic:0,returnType:P.vector},sort:{name:"sort",argTypes:[P.vector],variadic:0,returnType:P.vector},sort_by_label:{name:"sort_by_label",argTypes:[P.vector,P.string],variadic:-1,returnType:P.vector},sort_by_label_desc:{name:"sort_by_label_desc",argTypes:[P.vector,P.string],variadic:-1,returnType:P.vector},sort_desc:{name:"sort_desc",argTypes:[P.vector],variadic:0,returnType:P.vector},sqrt:{name:"sqrt",argTypes:[P.vector],variadic:0,returnType:P.vector},stddev_over_time:{name:"stddev_over_time",argTypes:[P.matrix],variadic:0,returnType:P.vector},stdvar_over_time:{name:"stdvar_over_time",argTypes:[P.matrix],variadic:0,returnType:P.vector},sum_over_time:{name:"sum_over_time",argTypes:[P.matrix],variadic:0,returnType:P.vector},tan:{name:"tan",argTypes:[P.vector],variadic:0,returnType:P.vector},tanh:{name:"tanh",argTypes:[P.vector],variadic:0,returnType:P.vector},time:{name:"time",argTypes:[],variadic:0,returnType:P.scalar},timestamp:{name:"timestamp",argTypes:[P.vector],variadic:0,returnType:P.vector},vector:{name:"vector",argTypes:[P.scalar],variadic:0,returnType:P.vector},year:{name:"year",argTypes:[P.vector],variadic:1,returnType:P.vector}},el=e=>e.includes("error")?"error":e.includes("waiting")?"waiting":e.includes("running")?"running":"success";function ed(e){let{node:r,parentEl:a,reverse:t,datasource:n,childIdx:i,reportNodeState:s}=e,o=(0,u.Z)(),l=U(r),[d,p]=(0,T.useState)(null),v=(0,T.useCallback)(e=>p(e),[]),[g,y]=(0,T.useState)({numSeries:0,labelExamples:{},sortedLabelCards:[]}),[x,h]=(0,T.useState)({borderColor:o.palette.grey["500"],borderLeftStyle:"solid",borderLeftWidth:2,width:25,left:-25}),[j,_]=(0,T.useState)(l.map(()=>"waiting")),b=(0,T.useMemo)(()=>el(j),[j]),E=r;E.type===F.matrixSelector&&(E={type:F.call,func:ec.last_over_time,args:[r]});let{data:Z,isFetching:S,error:k}=function(e,r,a){let{data:t}=(0,f.useDatasourceClient)(r);return(0,$.useQuery)({enabled:!!t&&a,queryKey:["instantQuery",e,"datasource",r.kind],queryFn:async()=>{let r=performance.now(),a=await t.instantQuery({query:e}),n=performance.now()-r;return{...a,responseTime:n}}})}(eo(E)??"",n,"success"===b);(0,T.useEffect)(()=>{s&&("error"===b||k?s(i,"error"):S&&s(i,"running"))},[b,k,S,s,i]);let L=(0,T.useCallback)((e,r)=>{_(a=>{let t=[...a];return t[e]=r,t})},[_]);(0,T.useLayoutEffect)(()=>{if(void 0===a||null===a||null===d)return;let e=a.getBoundingClientRect(),r=d.getBoundingClientRect();t?h(a=>({...a,top:"calc(50% - 1px)",bottom:r.bottom-e.top,borderTopLeftRadius:10,borderTopStyle:"solid",borderBottomLeftRadius:void 0})):h(a=>({...a,top:e.bottom-r.top,bottom:"calc(50% - 1px)",borderBottomLeftRadius:10,borderBottomStyle:"solid",borderTopLeftRadius:void 0}))},[a,d,t,v,h]),(0,T.useEffect)(()=>{if((null==Z?void 0:Z.status)!=="success")return;s&&s(i,"success");let e=0,r={},{resultType:a,result:t}=Z.data;"scalar"===a||"string"===a?e=1:t&&t.length>0&&(e=t.length,t.forEach(e=>{Object.entries(e.metric).forEach(e=>{let[a,t]=e;"__name__"!==a&&(r[a]=r[a]??{},r[a][t]=(r[a][t]??0)+1)})}));let n={},o={};Object.entries(r).forEach(e=>{let[r,a]=e;n[r]=Object.keys(a).length,o[r]=Object.entries(a).sort((e,r)=>{let[,a]=e,[,t]=r;return t-a}).slice(0,10).map(e=>{let[r,a]=e;return{value:r,count:a}})}),y({numSeries:e,sortedLabelCards:Object.entries(n).sort((e,r)=>r[1]-e[1]),labelExamples:o})},[Z,s,i]);let q=(0,c.jsxs)(m.Z,{direction:"row",gap:2,children:[(0,c.jsxs)(w.Z,{ref:v,sx:{position:"relative",display:"inline-block",padding:1,marginBottom:1.5,borderRadius:2,backgroundColor:o.palette.background.code},children:[void 0!==a&&(0,c.jsx)(w.Z,{sx:{position:"absolute",display:"inline-block",...x}}),en(r,!1,1)]}),(0,c.jsx)(ep,{mergedChildState:b,isFetching:S,error:k,resultStats:g,responseTime:null==Z?void 0:Z.responseTime})]});return r.type===F.binaryExpr?(0,c.jsxs)("div",{children:[(0,c.jsx)(w.Z,{ml:5,children:(0,c.jsx)(ed,{node:l[0],parentEl:d,reverse:!0,datasource:n,childIdx:0,reportNodeState:L})}),q,(0,c.jsx)(w.Z,{ml:5,children:(0,c.jsx)(ed,{node:l[1],parentEl:d,reverse:!1,datasource:n,childIdx:1,reportNodeState:L})})]}):(0,c.jsxs)("div",{children:[q,l.map((e,r)=>(0,c.jsx)(w.Z,{ml:5,children:(0,c.jsx)(ed,{node:e,parentEl:d,reverse:!1,datasource:n,childIdx:r,reportNodeState:L})},r))]})}function ep(e){let{mergedChildState:r,isFetching:a,error:t,resultStats:n,responseTime:i}=e;return"waiting"===r?(0,c.jsx)(eu,{text:"Waiting for child query"}):"running"===r?(0,c.jsx)(eu,{text:"Running"}):"error"===r?(0,c.jsxs)(m.Z,{children:[(0,c.jsx)(L.default,{}),"Blocked on child query error"]}):a?(0,c.jsx)(eu,{text:"Loading"}):t?(0,c.jsxs)(w.Z,{display:"flex",alignItems:"center",gap:1,sx:{color:e=>e.palette.error.main},marginBottom:1.5,children:[(0,c.jsx)(L.default,{}),(0,c.jsxs)(E.Z,{variant:"body2",children:[(0,c.jsx)("strong",{children:"Error executing query:"})," ",t.message]})]}):(0,c.jsxs)(m.Z,{direction:"row",gap:1,alignItems:"center",marginBottom:1.5,children:[(0,c.jsxs)(E.Z,{variant:"body2",component:"span",sx:{color:e=>e.palette.grey[500]},children:[n.numSeries," result",1!==n.numSeries&&"s","\xa0\xa0–\xa0\xa0",i,"ms",n.sortedLabelCards.length>0&&(0,c.jsx)(c.Fragment,{children:"\xa0\xa0–"})]}),n.sortedLabelCards.slice(0,10).map(e=>{var r;let[a,t]=e;return(0,c.jsx)(g.Z,{title:(0,c.jsx)(w.Z,{children:(0,c.jsxs)(Z.Z,{dense:!0,children:[null===(r=n.labelExamples[a])||void 0===r?void 0:r.map(e=>{let{value:r,count:a}=e;return(0,c.jsxs)(S.ZP,{sx:{display:"flex",gap:1,py:0,px:.5},children:[(0,c.jsx)(k.default,{sx:{fontSize:8}}),(0,c.jsx)(E.Z,{variant:"body2",component:"span",sx:{color:e=>"dark"===e.palette.mode?e.palette.warning.dark:e.palette.warning.main,fontFamily:"monospace"},children:K(r)}),(0,c.jsxs)(E.Z,{variant:"body2",component:"span",children:["(",a,"x)"]})]},r)}),t>10&&(0,c.jsxs)(S.ZP,{sx:{display:"flex",gap:1,py:0,px:.5},children:[(0,c.jsx)(k.default,{sx:{fontSize:8}}),(0,c.jsx)(E.Z,{variant:"body2",children:". . ."})]})]})}),arrow:!0,children:(0,c.jsxs)("span",{style:{cursor:"pointer",whiteSpace:"nowrap"},children:[(0,c.jsx)(E.Z,{variant:"body2",component:"span",sx:{fontFamily:"monospace",color:e=>e.palette.success.main},children:a}),(0,c.jsxs)(E.Z,{variant:"body2",component:"span",sx:{color:e=>e.palette.grey[500]},children:[": ",t]})]})},a)}),n.sortedLabelCards.length>10?(0,c.jsxs)(E.Z,{variant:"body2",children:["...",n.sortedLabelCards.length-10," more..."]}):null]})}function eu(e){let{text:r}=e;return(0,c.jsxs)(w.Z,{display:"flex",alignItems:"center",gap:1,marginBottom:1.5,children:[(0,c.jsx)(x.Z,{size:16,color:"secondary"}),(0,c.jsxs)(E.Z,{variant:"body2",color:"text.secondary",children:[r,"..."]})]})}let em="Tree View",ev="Open "+em,eg="Close "+em;function ey(e){let{completeConfig:r,datasource:a,...t}=e,n=(0,u.Z)(),i="dark"===n.palette.mode,[s,o]=(0,T.useState)(!1),w=(0,T.useMemo)(()=>new d.q9().activateLinter(!1).setComplete(r).asExtension(),[r]),E=(0,f.useReplaceVariablesInString)(t.value);E&&(E=(0,b.d)(E,12345,12345));let{data:Z,isLoading:S,error:k}=function(e,r,a){let{data:t}=(0,f.useDatasourceClient)(r);return(0,$.useQuery)({enabled:!!t&&a,queryKey:["parseQuery",e,"datasource",r],queryFn:async()=>await t.parseQuery({query:e})})}(E??"",a,s);return(0,c.jsxs)(m.Z,{position:"relative",children:[(0,c.jsx)(v.Z,{shrink:!0,sx:{position:"absolute",top:"-8px",left:"10px",padding:"0 4px",color:n.palette.text.primary,zIndex:1},children:"PromQL Expression"}),(0,c.jsx)(l.ZP,{...t,style:{border:`1px solid ${n.palette.divider}`},theme:i?"dark":"light",basicSetup:{highlightActiveLine:!1,highlightActiveLineGutter:!1,foldGutter:!1},extensions:[p.tk.lineWrapping,w,p.tk.theme({".cm-content":{paddingTop:"8px",paddingBottom:"8px",paddingRight:"40px"}})],placeholder:"Example: sum(rate(http_requests_total[5m]))"}),E&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(g.Z,{title:s?eg:ev,children:(0,c.jsx)(y.Z,{"aria-label":s?eg:ev,onClick:()=>{o(!s)},sx:{position:"absolute",right:"5px",top:"5px"},size:"small",children:(0,c.jsx)(h.default,{sx:{fontSize:"18px"}})},"tree-view-button")}),s&&(0,c.jsxs)("div",{style:{border:`1px solid ${n.palette.divider}`,position:"relative"},children:[(0,c.jsx)(g.Z,{title:eg,children:(0,c.jsx)(y.Z,{"aria-label":eg,onClick:()=>o(!1),sx:{position:"absolute",top:"5px",right:"5px"},size:"small",children:(0,c.jsx)(_.default,{sx:{fontSize:"18px"}})},"tree-view-close-button")}),k?(0,c.jsx)(j.ErrorAlert,{error:{name:`${em} not available`,message:k.message}}):(0,c.jsx)("div",{style:{padding:`${n.spacing(1.5)} ${n.spacing(1.5)} 0 ${n.spacing(1.5)}`,overflowX:"auto",backgroundColor:n.palette.background.default},children:S?(0,c.jsx)(x.Z,{}):(null==Z?void 0:Z.data)?(0,c.jsx)(ed,{node:Z.data,reverse:!1,childIdx:0,datasource:a}):null})]})]})]})}},87629:function(e,r,a){function t(e){let[r,a]=e;return[1e3*r,function(e){let r;switch(e){case"+Inf":r=Number.POSITIVE_INFINITY;break;case"-Inf":r=Number.NEGATIVE_INFINITY;break;default:r=parseFloat(e)}return r}(a)]}a.d(r,{X2:()=>d,mB:()=>u,mY:()=>c,k7:()=>f,c4:()=>i,Nr:()=>s,Mm:()=>x.Mm,Fp:()=>o,Rv:()=>x.Rv,sv:()=>x.sv,ac:()=>p,qJ:()=>t,nY:()=>x.nY,Bf:()=>j,PL:()=>l,wd:()=>_});var n=a(35015);function i(e){return async()=>{let r=`${e.datasourceUrl}/-/healthy`;try{let a=await (0,n.he)(r,{headers:e.headers});return 200===a.status}catch{return!1}}}function s(e,r){return v("/api/v1/query",e,r)}function o(e,r){return v("/api/v1/query_range",e,r)}function c(e,r){return v("/api/v1/labels",e,r)}function l(e,r){let{labelName:a,...t}=e;return 0===a.length?new Promise(e=>{e({data:[]})}):m(`/api/v1/label/${encodeURIComponent(a)}/values`,t,r)}function d(e,r){return m("/api/v1/metadata",e,r)}function p(e,r){return v("/api/v1/series",e,r)}function u(e,r){return v("/api/v1/parse_query",e,r)}function m(e,r,a){let{datasourceUrl:t,headers:i}=a,s=`${t}${e}`,o=g(r).toString();return""!==o&&(s+=`?${o}`),(0,n.rd)(s,{method:"GET",headers:i})}function v(e,r,a){let{datasourceUrl:t,headers:n}=a;return y(`${t}${e}`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",...n},body:g(r)})}function g(e){let r=new URLSearchParams;for(let a in e){let t=e[a];if(void 0!==t){if("string"==typeof t){r.append(a,t);continue}if("number"==typeof t){r.append(a,t.toString());continue}for(let e of t)r.append(a,e)}}return r}async function y(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];let t=await (0,n.he)(...r);return{...await t.json(),rawResponse:t}}var x=a(65456),h=a(29085),T=a(20461);function j(e){let{start:r,end:a}=e;return{start:Math.ceil((0,T.getUnixTime)(r)),end:Math.ceil((0,T.getUnixTime)(a))}}function _(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=(e.end-e.start)/1e4;return n>1&&(n=Math.ceil(n)),Math.max(t/1e3*a,r,n)}function f(e){if(!e)return;let r=(0,h.Ib)(e);return Math.floor((0,T.milliseconds)(r)/1e3)}},65456:function(e,r,a){a.d(r,{Mm:()=>i,Rv:()=>s,nY:()=>n,sv:()=>o});var t=a(58891);let n="PrometheusDatasource",i={kind:n};function s(e){return!(0,t.isVariableDatasource)(e)&&void 0===e.name}function o(e){return(0,t.isVariableDatasource)(e)||e.kind===n}},6421:function(e,r,a){a.d(r,{d:()=>i});var t=a(58891),n=a(29085);function i(e,r,a){let i=(0,t.replaceVariable)(e,"__interval_ms",a.toString());i=(0,t.replaceVariable)(i,"__interval",(0,n.LU)((0,n.oK)(a)));let s=Math.max(a+r,4*r);return(0,t.replaceVariable)(i,"__rate_interval",(0,n.LU)((0,n.oK)(s)))}}}]);