{"version":3,"sources":["../../../src/components/Filters.tsx"],"sourcesContent":["// Copyright 2025 The Perses Authors\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { ReactElement } from 'react';\nimport { InputLabel, Stack, useTheme } from '@mui/material';\nimport { PyroscopeDatasourceSelector } from '../model';\nimport { LabelFilter } from '../utils/types';\nimport { FilterItem } from './FilterItem';\nimport { AddFilterItem } from './AddFilterItem';\n\nexport interface FiltersProps {\n  datasource: PyroscopeDatasourceSelector;\n  value: LabelFilter[];\n  onChange?: (value: LabelFilter[]) => void;\n}\n\nexport function Filters(props: FiltersProps): ReactElement {\n  const theme = useTheme();\n  const { datasource, value, onChange } = props;\n\n  const addFilterItem = () => {\n    const newItem: LabelFilter = { labelName: '', labelValue: '', operator: '=' };\n    const updatedFilters = [...value, newItem];\n    onChange?.(updatedFilters);\n  };\n\n  const updateFilter = (index: number, newValue: LabelFilter) => {\n    const nextFilters = [...value];\n    nextFilters[index] = newValue;\n    onChange?.(nextFilters);\n  };\n\n  const deleteFilter = (index: number) => {\n    const nextFilters = [...value];\n    nextFilters.splice(index, 1);\n    if (nextFilters.length === 0) {\n      onChange?.([{ labelName: '', labelValue: '', operator: '=' }]); // keep at least one empty filter\n    } else {\n      onChange?.(nextFilters);\n    }\n  };\n\n  return (\n    <Stack\n      position=\"relative\"\n      direction=\"row\"\n      spacing={0}\n      sx={{\n        flexWrap: 'wrap',\n        rowGap: 1,\n        gap: 1,\n        padding: '10px',\n        border: `1px solid ${theme.palette.action.disabled}`,\n        borderRadius: `${theme.shape.borderRadius}px`,\n        '&:hover': {\n          borderColor: theme.palette.text.primary,\n        },\n      }}\n    >\n      <InputLabel\n        shrink\n        sx={{\n          position: 'absolute',\n          top: '-6px',\n          left: '10px',\n          padding: '0 4px',\n          color: theme.palette.text.primary,\n          backgroundColor: theme.palette.background.default,\n          zIndex: 1,\n        }}\n      >\n        Filters\n      </InputLabel>\n      {value.map((filter, index) => (\n        <FilterItem\n          key={`${filter.labelName}:${filter.operator}:${filter.labelValue}`}\n          datasource={datasource}\n          value={filter}\n          onChange={(newValue) => updateFilter(index, newValue)}\n          deleteItem={() => deleteFilter(index)}\n        />\n      ))}\n      <AddFilterItem onClick={addFilterItem} />\n    </Stack>\n  );\n}\n"],"names":["InputLabel","Stack","useTheme","FilterItem","AddFilterItem","Filters","props","theme","datasource","value","onChange","addFilterItem","newItem","labelName","labelValue","operator","updatedFilters","updateFilter","index","newValue","nextFilters","deleteFilter","splice","length","position","direction","spacing","sx","flexWrap","rowGap","gap","padding","border","palette","action","disabled","borderRadius","shape","borderColor","text","primary","shrink","top","left","color","backgroundColor","background","default","zIndex","map","filter","deleteItem","onClick"],"mappings":"AAAA,oCAAoC;AACpC,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,6CAA6C;AAC7C,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;;AAGjC,SAASA,UAAU,EAAEC,KAAK,EAAEC,QAAQ,QAAQ,gBAAgB;AAG5D,SAASC,UAAU,QAAQ,eAAe;AAC1C,SAASC,aAAa,QAAQ,kBAAkB;AAQhD,OAAO,SAASC,QAAQC,KAAmB;IACzC,MAAMC,QAAQL;IACd,MAAM,EAAEM,UAAU,EAAEC,KAAK,EAAEC,QAAQ,EAAE,GAAGJ;IAExC,MAAMK,gBAAgB;QACpB,MAAMC,UAAuB;YAAEC,WAAW;YAAIC,YAAY;YAAIC,UAAU;QAAI;QAC5E,MAAMC,iBAAiB;eAAIP;YAAOG;SAAQ;QAC1CF,WAAWM;IACb;IAEA,MAAMC,eAAe,CAACC,OAAeC;QACnC,MAAMC,cAAc;eAAIX;SAAM;QAC9BW,WAAW,CAACF,MAAM,GAAGC;QACrBT,WAAWU;IACb;IAEA,MAAMC,eAAe,CAACH;QACpB,MAAME,cAAc;eAAIX;SAAM;QAC9BW,YAAYE,MAAM,CAACJ,OAAO;QAC1B,IAAIE,YAAYG,MAAM,KAAK,GAAG;YAC5Bb,WAAW;gBAAC;oBAAEG,WAAW;oBAAIC,YAAY;oBAAIC,UAAU;gBAAI;aAAE,GAAG,iCAAiC;QACnG,OAAO;YACLL,WAAWU;QACb;IACF;IAEA,qBACE,MAACnB;QACCuB,UAAS;QACTC,WAAU;QACVC,SAAS;QACTC,IAAI;YACFC,UAAU;YACVC,QAAQ;YACRC,KAAK;YACLC,SAAS;YACTC,QAAQ,CAAC,UAAU,EAAEzB,MAAM0B,OAAO,CAACC,MAAM,CAACC,QAAQ,EAAE;YACpDC,cAAc,GAAG7B,MAAM8B,KAAK,CAACD,YAAY,CAAC,EAAE,CAAC;YAC7C,WAAW;gBACTE,aAAa/B,MAAM0B,OAAO,CAACM,IAAI,CAACC,OAAO;YACzC;QACF;;0BAEA,KAACxC;gBACCyC,MAAM;gBACNd,IAAI;oBACFH,UAAU;oBACVkB,KAAK;oBACLC,MAAM;oBACNZ,SAAS;oBACTa,OAAOrC,MAAM0B,OAAO,CAACM,IAAI,CAACC,OAAO;oBACjCK,iBAAiBtC,MAAM0B,OAAO,CAACa,UAAU,CAACC,OAAO;oBACjDC,QAAQ;gBACV;0BACD;;YAGAvC,MAAMwC,GAAG,CAAC,CAACC,QAAQhC,sBAClB,KAACf;oBAECK,YAAYA;oBACZC,OAAOyC;oBACPxC,UAAU,CAACS,WAAaF,aAAaC,OAAOC;oBAC5CgC,YAAY,IAAM9B,aAAaH;mBAJ1B,GAAGgC,OAAOrC,SAAS,CAAC,CAAC,EAAEqC,OAAOnC,QAAQ,CAAC,CAAC,EAAEmC,OAAOpC,UAAU,EAAE;0BAOtE,KAACV;gBAAcgD,SAASzC;;;;AAG9B"}