/*! For license information please see __federation_expose_ScatterChart.ec1c47a4.js.LICENSE.txt */
"use strict";(self.webpackChunkScatterChart=self.webpackChunkScatterChart||[]).push([["285"],{1426:function(e,t,r){var o=r(4538),a=Symbol.for("react.element"),n=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,s=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,r){var o,n={},l=null,c=null;for(o in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(c=t.ref),t)i.call(t,o)&&!u.hasOwnProperty(o)&&(n[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===n[o]&&(n[o]=t[o]);return{$$typeof:a,type:e,key:l,ref:c,props:n,_owner:s.current}}t.Fragment=n,t.jsx=l,t.jsxs=l},4179:function(e,t,r){r.r(t),r.d(t,{ScatterChart:()=>a});var o=r(9069);let a={PanelComponent:r(8174).q,supportedQueryTypes:["TraceQuery"],createInitialOptions:o.W}},8174:function(e,t,r){r.d(t,{q:()=>l});var o=r(4246),a=r(4538),n=r(2629),i=r(7065);let s=[6,20];function u(e){let t=JSON.parse(JSON.stringify(e.query));t.spec.plugin.spec.query=e.traceId;let r=new URLSearchParams({explorer:"traces",data:JSON.stringify({queries:[t]})});window.location.href=`/explore?${r}`}function l(e){let{spec:t,contentDimensions:r,queryResults:l,onClick:c}=e,d=(0,n.useChartsTheme)().thresholds.defaultColor||"blue",m=t.sizeRange||s,{dataset:f,minSpanCount:h,maxSpanCount:p}=(0,a.useMemo)(()=>{let e,t;let r=[];for(let o of l){if(void 0===o.data.searchResult)continue;let a=o.data.searchResult.map(r=>{let a=0,n=0;for(let e of Object.values(r.serviceStats))a+=e.spanCount,n+=e.errorCount??0;return(void 0===e||a<e)&&(e=a),(void 0===t||a>t)&&(t=a),{...r,query:o.definition,name:`${r.rootServiceName}: ${r.rootTraceName}`,startTime:new Date(r.startTimeUnixMs),spanCount:a,errorCount:n}});r.push({source:a})}return{dataset:r,minSpanCount:e??0,maxSpanCount:t??0}},[l]),y=(0,a.useMemo)(()=>{let e={type:"scatter",encode:{x:"startTime",y:"durationMs"},symbolSize:function(e){return function(e,t,r){let[o,a]=r,[n,i]=t;return i-n==0?a:o+(e-n)/(i-n)*(a-o)}(e.spanCount,[h,p],m)},itemStyle:{color:function(e){return e.data.errorCount>0?"red":d}}},t=[];for(let r=0;r<f.length;r++)t.push({...e,datasetIndex:r});return t},[f,d,h,p,m]);return l.some(e=>{var t;return((null===(t=e.data)||void 0===t?void 0:t.searchResult)??[]).length>0})?void 0===r?null:(0,o.jsx)("div",{"data-testid":"ScatterChartPanel_ScatterPlot",children:(0,o.jsx)(i.h,{width:r.width,height:r.height,options:{dataset:f,series:y},onClick:null===c?void 0:c??u})}):(0,o.jsx)(n.NoDataOverlay,{resource:"traces"})}},7065:function(e,t,r){r.d(t,{h:()=>b});var o=r(4246),a=r(4538),n=r(2629),i=r(6232),s=r(8890),u=r(9635),l=r(8480),c=r(7806),d=r(5201),m=r(3709),f=r(7745),h=r(378),p=r(4664);(0,i.D)([u.N,l.N,c.N,s.N,d.N,m.N,f.N,h.N]);let y=new Intl.DateTimeFormat(void 0,{dateStyle:"long",timeStyle:"medium"}).format;function b(e){let{width:t,height:r,options:i,onClick:s}=e,u=(0,n.useChartsTheme)(),l={dataset:i.dataset,series:i.series,dataZoom:i.dataZoom,grid:{bottom:40,top:50,left:50,right:100},xAxis:{type:"time",name:"Local Time"},yAxis:{scale:!0,type:"value",name:"Duration",axisLabel:{formatter:e=>(0,p.Bw)(e,{unit:"milliseconds"})}},animation:!1,tooltip:{padding:5,borderWidth:1,trigger:"axis",axisPointer:{type:"cross"},formatter:function(e){let t=e[0].data;return`<b>Service name</b>: ${t.rootServiceName}<br/><b>Span name</b>: ${t.rootTraceName}<br/><b>Time</b>: ${y(t.startTime)}<br/><b>Duration</b>: ${(0,p.Bw)(t.durationMs,{unit:"milliseconds"})}<br/><b>Span count</b>: ${t.spanCount} (${t.errorCount} errors)<br/>`}},legend:{show:!0,type:"scroll",orient:"horizontal",bottom:0}},c=(0,a.useMemo)(()=>{let e={};return s&&(e.click=e=>s(e.data)),e},[s]);return(0,o.jsx)(n.EChart,{sx:{width:t,height:r},option:l,theme:u.echartsTheme,onEvents:c})}},9069:function(e,t,r){r.d(t,{W:()=>o});function o(){return{}}}}]);