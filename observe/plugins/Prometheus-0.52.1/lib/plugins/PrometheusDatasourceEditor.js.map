{"version":3,"sources":["../../../src/plugins/PrometheusDatasourceEditor.tsx"],"sourcesContent":["// Copyright 2023 The Perses Authors\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { DurationString } from '@perses-dev/core';\nimport { HTTPSettingsEditor } from '@perses-dev/plugin-system';\nimport { TextField, Typography } from '@mui/material';\nimport React, { ReactElement } from 'react';\nimport { DEFAULT_SCRAPE_INTERVAL, PrometheusDatasourceSpec } from './types';\n\nexport interface PrometheusDatasourceEditorProps {\n  value: PrometheusDatasourceSpec;\n  onChange: (next: PrometheusDatasourceSpec) => void;\n  isReadonly?: boolean;\n}\n\nexport function PrometheusDatasourceEditor(props: PrometheusDatasourceEditorProps): ReactElement {\n  const { value, onChange, isReadonly } = props;\n\n  const initialSpecDirect: PrometheusDatasourceSpec = {\n    directUrl: '',\n  };\n\n  const initialSpecProxy: PrometheusDatasourceSpec = {\n    proxy: {\n      kind: 'HTTPProxy',\n      spec: {\n        allowedEndpoints: [\n          // list of standard endpoints suggested by default\n          {\n            endpointPattern: '/api/v1/labels',\n            method: 'POST',\n          },\n          {\n            endpointPattern: '/api/v1/series',\n            method: 'POST',\n          },\n          {\n            endpointPattern: '/api/v1/metadata',\n            method: 'GET',\n          },\n          {\n            endpointPattern: '/api/v1/query',\n            method: 'POST',\n          },\n          {\n            endpointPattern: '/api/v1/query_range',\n            method: 'POST',\n          },\n          {\n            endpointPattern: '/api/v1/label/([a-zA-Z0-9_-]+)/values',\n            method: 'GET',\n          },\n          {\n            endpointPattern: '/api/v1/parse_query',\n            method: 'POST',\n          },\n        ],\n        url: '',\n      },\n    },\n  };\n\n  return (\n    <>\n      <Typography variant=\"h4\" mb={2}>\n        General Settings\n      </Typography>\n      <TextField\n        fullWidth\n        label=\"Scrape Interval\"\n        value={value.scrapeInterval || ''}\n        placeholder={`Default: ${DEFAULT_SCRAPE_INTERVAL}`}\n        InputProps={{\n          readOnly: isReadonly,\n        }}\n        InputLabelProps={{ shrink: isReadonly ? true : undefined }}\n        onChange={(e) => onChange({ ...value, scrapeInterval: e.target.value as DurationString })}\n      />\n      <HTTPSettingsEditor\n        value={value}\n        onChange={onChange}\n        isReadonly={isReadonly}\n        initialSpecDirect={initialSpecDirect}\n        initialSpecProxy={initialSpecProxy}\n      />\n    </>\n  );\n}\n"],"names":["HTTPSettingsEditor","TextField","Typography","React","DEFAULT_SCRAPE_INTERVAL","PrometheusDatasourceEditor","props","value","onChange","isReadonly","initialSpecDirect","directUrl","initialSpecProxy","proxy","kind","spec","allowedEndpoints","endpointPattern","method","url","variant","mb","fullWidth","label","scrapeInterval","placeholder","InputProps","readOnly","InputLabelProps","shrink","undefined","e","target"],"mappings":"AAAA,oCAAoC;AACpC,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,6CAA6C;AAC7C,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;;AAGjC,SAASA,kBAAkB,QAAQ,4BAA4B;AAC/D,SAASC,SAAS,EAAEC,UAAU,QAAQ,gBAAgB;AACtD,OAAOC,WAA6B,QAAQ;AAC5C,SAASC,uBAAuB,QAAkC,UAAU;AAQ5E,OAAO,SAASC,2BAA2BC,KAAsC;IAC/E,MAAM,EAAEC,KAAK,EAAEC,QAAQ,EAAEC,UAAU,EAAE,GAAGH;IAExC,MAAMI,oBAA8C;QAClDC,WAAW;IACb;IAEA,MAAMC,mBAA6C;QACjDC,OAAO;YACLC,MAAM;YACNC,MAAM;gBACJC,kBAAkB;oBAChB,kDAAkD;oBAClD;wBACEC,iBAAiB;wBACjBC,QAAQ;oBACV;oBACA;wBACED,iBAAiB;wBACjBC,QAAQ;oBACV;oBACA;wBACED,iBAAiB;wBACjBC,QAAQ;oBACV;oBACA;wBACED,iBAAiB;wBACjBC,QAAQ;oBACV;oBACA;wBACED,iBAAiB;wBACjBC,QAAQ;oBACV;oBACA;wBACED,iBAAiB;wBACjBC,QAAQ;oBACV;oBACA;wBACED,iBAAiB;wBACjBC,QAAQ;oBACV;iBACD;gBACDC,KAAK;YACP;QACF;IACF;IAEA,qBACE;;0BACE,KAACjB;gBAAWkB,SAAQ;gBAAKC,IAAI;0BAAG;;0BAGhC,KAACpB;gBACCqB,SAAS;gBACTC,OAAM;gBACNhB,OAAOA,MAAMiB,cAAc,IAAI;gBAC/BC,aAAa,CAAC,SAAS,EAAErB,yBAAyB;gBAClDsB,YAAY;oBACVC,UAAUlB;gBACZ;gBACAmB,iBAAiB;oBAAEC,QAAQpB,aAAa,OAAOqB;gBAAU;gBACzDtB,UAAU,CAACuB,IAAMvB,SAAS;wBAAE,GAAGD,KAAK;wBAAEiB,gBAAgBO,EAAEC,MAAM,CAACzB,KAAK;oBAAmB;;0BAEzF,KAACP;gBACCO,OAAOA;gBACPC,UAAUA;gBACVC,YAAYA;gBACZC,mBAAmBA;gBACnBE,kBAAkBA;;;;AAI1B"}