"use strict";(self.webpackChunkPrometheus=self.webpackChunkPrometheus||[]).push([["1301"],{35015:function(e,t,n){async function a(...e){let t=await n.g.fetch(...e);if(!1===t.ok){let e=t.headers.get("content-type");if(e?.includes("application/json")){let e=await t.json();if(e.error)throw new s(e.error,t.status);if(e.message)throw new s(e.message,t.status)}let n=await t.text();if(n)throw new s(n,t.status);throw new i(t)}return t}async function r(...e){let t=await a(...e);return await t.json()}n.d(t,{he:()=>a,rd:()=>r});class i extends Error{status;constructor(e){super(`${e.status} ${e.statusText}`),this.status=e.status,Object.setPrototypeOf(this,i.prototype)}}class s extends Error{status;constructor(e,t){super(e),this.status=t,Object.setPrototypeOf(this,s.prototype)}}},87629:function(e,t,n){function a(e){let[t,n]=e;return[1e3*t,function(e){let t;switch(e){case"+Inf":t=Number.POSITIVE_INFINITY;break;case"-Inf":t=Number.NEGATIVE_INFINITY;break;default:t=parseFloat(e)}return t}(n)]}n.d(t,{X2:()=>c,mB:()=>p,mY:()=>l,k7:()=>g,c4:()=>i,Nr:()=>s,Mm:()=>_.Mm,Fp:()=>o,Rv:()=>_.Rv,sv:()=>_.sv,ac:()=>d,qJ:()=>a,nY:()=>_.nY,Bf:()=>w,PL:()=>u,wd:()=>b});var r=n(35015);function i(e){return async()=>{let t=`${e.datasourceUrl}/-/healthy`;try{let n=await (0,r.he)(t,{headers:e.headers});return 200===n.status}catch{return!1}}}function s(e,t){return f("/api/v1/query",e,t)}function o(e,t){return f("/api/v1/query_range",e,t)}function l(e,t){return f("/api/v1/labels",e,t)}function u(e,t){let{labelName:n,...a}=e;return 0===n.length?new Promise(e=>{e({data:[]})}):h(`/api/v1/label/${encodeURIComponent(n)}/values`,a,t)}function c(e,t){return h("/api/v1/metadata",e,t)}function d(e,t){return f("/api/v1/series",e,t)}function p(e,t){return f("/api/v1/parse_query",e,t)}function h(e,t,n){let{datasourceUrl:a,headers:i}=n,s=`${a}${e}`,o=v(t).toString();return""!==o&&(s+=`?${o}`),(0,r.rd)(s,{method:"GET",headers:i})}function f(e,t,n){let{datasourceUrl:a,headers:r}=n;return m(`${a}${e}`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",...r},body:v(t)})}function v(e){let t=new URLSearchParams;for(let n in e){let a=e[n];if(void 0!==a){if("string"==typeof a){t.append(n,a);continue}if("number"==typeof a){t.append(n,a.toString());continue}for(let e of a)t.append(n,e)}}return t}async function m(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let a=await (0,r.he)(...t);return{...await a.json(),rawResponse:a}}var _=n(65456),y=n(29085),P=n(20461);function w(e){let{start:t,end:n}=e;return{start:Math.ceil((0,P.getUnixTime)(t)),end:Math.ceil((0,P.getUnixTime)(n))}}function b(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=(e.end-e.start)/1e4;return r>1&&(r=Math.ceil(r)),Math.max(a/1e3*n,t,r)}function g(e){if(!e)return;let t=(0,y.Ib)(e);return Math.floor((0,P.milliseconds)(t)/1e3)}},65456:function(e,t,n){n.d(t,{Mm:()=>i,Rv:()=>s,nY:()=>r,sv:()=>o});var a=n(58891);let r="PrometheusDatasource",i={kind:r};function s(e){return!(0,a.isVariableDatasource)(e)&&void 0===e.name}function o(e){return(0,a.isVariableDatasource)(e)||e.kind===r}},56276:function(e,t,n){n.r(t),n.d(t,{PrometheusDatasource:()=>u});var a=n(87629),r=n(24246),i=n(58891),s=n(52054),o=n(8695);n(54538);var l=n(13690);let u={createClient:(e,t)=>{let{directUrl:n,proxy:r}=e,{proxyUrl:i}=t,s=n??i;if(void 0===s)throw Error("No URL specified for Prometheus client. You can use directUrl in the spec to configure it.");let o=null==r?void 0:r.spec.headers;return{options:{datasourceUrl:s},healthCheck:(0,a.c4)({datasourceUrl:s,headers:o}),instantQuery:(e,t)=>(0,a.Nr)(e,{datasourceUrl:s,headers:t??o}),rangeQuery:(e,t)=>(0,a.Fp)(e,{datasourceUrl:s,headers:t??o}),labelNames:(e,t)=>(0,a.mY)(e,{datasourceUrl:s,headers:t??o}),labelValues:(e,t)=>(0,a.PL)(e,{datasourceUrl:s,headers:t??o}),metricMetadata:(e,t)=>(0,a.X2)(e,{datasourceUrl:s,headers:t??o}),series:(e,t)=>(0,a.ac)(e,{datasourceUrl:s,headers:t??o}),parseQuery:(e,t)=>(0,a.mB)(e,{datasourceUrl:s,headers:t??o})}},getBuiltinVariableDefinitions:()=>[{kind:"BuiltinVariable",spec:{name:"__interval",value:()=>"$__interval",source:"Prometheus",display:{name:"__interval",description:'For dynamic queries that adapt across different time ranges, use $__interval instead of hardcoded intervals. It represents the actual spacing between data points: itâ€™s calculated based on the current time range and the panel pixel width (taking the "Min step" as a lower bound).',hidden:!0}}},{kind:"BuiltinVariable",spec:{name:"__interval_ms",value:()=>"$__interval_ms",source:"Prometheus",display:{name:"__interval_ms",description:"Same as $__interval but in milliseconds.",hidden:!0}}},{kind:"BuiltinVariable",spec:{name:"__rate_interval",value:()=>"$__rate_interval",source:"Prometheus",display:{name:"__rate_interval",description:"Use this one rather than $__interval as the range parameter of functions like rate, increase, etc. With such function it is advised to choose a range that is at least 4x the scrape interval (this is to allow for various races, and to be resilient to a failed scrape). $__rate_interval provides that, as it is defined as `max($__interval + Min Step, 4 * Min Step)`, where Min Step value should represent the scrape interval of the metrics.",hidden:!0}}}],OptionsEditorComponent:function(e){let{value:t,onChange:n,isReadonly:a}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.Z,{variant:"h4",mb:2,children:"General Settings"}),(0,r.jsx)(o.Z,{fullWidth:!0,label:"Scrape Interval",value:t.scrapeInterval||"",placeholder:`Default: ${l.v}`,InputProps:{readOnly:a},InputLabelProps:{shrink:!!a||void 0},onChange:e=>n({...t,scrapeInterval:e.target.value})}),(0,r.jsx)(i.HTTPSettingsEditor,{value:t,onChange:n,isReadonly:a,initialSpecDirect:{directUrl:""},initialSpecProxy:{proxy:{kind:"HTTPProxy",spec:{allowedEndpoints:[{endpointPattern:"/api/v1/labels",method:"POST"},{endpointPattern:"/api/v1/series",method:"POST"},{endpointPattern:"/api/v1/metadata",method:"GET"},{endpointPattern:"/api/v1/query",method:"POST"},{endpointPattern:"/api/v1/query_range",method:"POST"},{endpointPattern:"/api/v1/label/([a-zA-Z0-9_-]+)/values",method:"GET"},{endpointPattern:"/api/v1/parse_query",method:"POST"}],url:""}}}})]})},createInitialOptions:()=>({directUrl:""})}},13690:function(e,t,n){n.d(t,{v:()=>a});let a="1m"}}]);