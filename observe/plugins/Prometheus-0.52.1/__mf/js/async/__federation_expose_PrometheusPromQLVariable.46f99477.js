"use strict";(self.webpackChunkPrometheus=self.webpackChunkPrometheus||[]).push([["3520"],{74081:function(e,a,r){a.default=void 0;var l,t=(l=r(30265))&&l.__esModule?l:{default:l};a.default=(0,t.default)("M9,3V4H4V6H5V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,19V6H20V4H15V3H9M9,8H11V17H9V8M13,8H15V17H13V8Z","TrashCan")},18920:function(e,a,r){r.r(a),r.d(a,{PrometheusPromQLVariable:()=>s});var l=r(58891),t=r(87629),n=r(90726);let s={getVariableOptions:async(e,a)=>{let r=await a.datasourceStore.getDatasourceClient(e.datasource??t.Mm),{data:s}=await r.instantQuery({query:(0,l.replaceVariables)(e.expr,a.variables)}),o=(0,l.replaceVariables)(e.labelName,a.variables),u=[];return(null==s?void 0:s.resultType)==="matrix"?u=(0,n.gB)(s,o):(null==s?void 0:s.resultType)==="vector"&&(u=(0,n.ik)(s,o)),{data:(0,n.LY)(u)}},dependsOn:e=>({variables:(0,l.parseVariables)(e.expr).concat((0,l.parseVariables)(e.labelName))}),OptionsEditorComponent:n.qT,createInitialOptions:()=>({expr:"",labelName:""})}},90726:function(e,a,r){r.d(a,{gB:()=>y,LY:()=>C,g3:()=>g,ik:()=>f,xA:()=>b,qT:()=>x});var l=r(24246),t=r(25283),n=r(90192),s=r(8695),o=r(58891),u=r(75586),i=r(82901),d=r(87629),c=r(36372),h=r(75094),m=r(48565),v=r(74081);function p(e){let{matchers:a,onChange:r,isReadonly:n}=e;return(0,l.jsxs)(t.Z,{spacing:1,mb:2,children:[a.map((e,t)=>(0,l.jsxs)(c.Z,{display:"flex",children:[(0,l.jsx)(s.Z,{fullWidth:!0,label:"Series Selector",value:e,InputProps:{readOnly:n},onChange:e=>{r((0,u.Uy)(a,a=>{a[t]=e.target.value}))}}),(0,l.jsx)(h.Z,{onClick:()=>{r((0,u.Uy)(a,e=>{e.splice(t,1)}))},disabled:n,children:(0,l.jsx)(v.default,{})})]},t)),(0,l.jsx)(c.Z,{children:(0,l.jsx)(m.Z,{fullWidth:!1,color:"secondary",variant:"outlined",onClick:()=>{r((0,u.Uy)(a,e=>{e.push("")}))},disabled:n,children:"Add Series Selector"})})]})}function b(e){let{onChange:a,value:r}=e,{datasource:i}=r,c=i??d.Mm;return(0,l.jsxs)(t.Z,{spacing:2,children:[(0,l.jsx)(n.Z,{margin:"dense",children:(0,l.jsx)(o.DatasourceSelect,{datasourcePluginKind:"PrometheusDatasource",value:c,onChange:e=>{if((0,d.sv)(e)){a((0,u.Uy)(r,a=>{a.datasource=(0,d.Rv)(e)?void 0:e}));return}throw Error("Got unexpected non-Prometheus datasource selector")},readOnly:e.isReadonly,labelId:"prom-datasource-label",label:"Prometheus Datasource"})}),(0,l.jsx)(s.Z,{label:"Label Name",required:!0,value:e.value.labelName,onChange:a=>{e.onChange({...e.value,labelName:a.target.value})},InputProps:{readOnly:e.isReadonly}}),(0,l.jsx)(p,{matchers:e.value.matchers??[],onChange:a=>{e.onChange({...e.value,matchers:a})},isReadonly:e.isReadonly})]})}function g(e){let{onChange:a,value:r}=e,{datasource:s}=r,i=s??d.Mm;return(0,l.jsxs)(t.Z,{spacing:2,children:[(0,l.jsx)(n.Z,{margin:"dense",children:(0,l.jsx)(o.DatasourceSelect,{datasourcePluginKind:"PrometheusDatasource",value:i,onChange:e=>{if((0,d.sv)(e)){a((0,u.Uy)(r,a=>{a.datasource=(0,d.Rv)(e)?void 0:e}));return}throw Error("Got unexpected non-Prometheus datasource selector")},disabled:e.isReadonly,labelId:"prom-datasource-label",label:"Prometheus Datasource"})}),(0,l.jsx)(p,{matchers:e.value.matchers??[],isReadonly:e.isReadonly,onChange:a=>{e.onChange({...e.value,matchers:a})}})]})}function x(e){let{onChange:a,value:r}=e,{datasource:c}=r,h=c??d.Mm,{data:m}=(0,o.useDatasourceClient)(h),v=null==m?void 0:m.options.datasourceUrl;return(0,l.jsxs)(t.Z,{spacing:2,children:[(0,l.jsx)(n.Z,{margin:"dense",children:(0,l.jsx)(o.DatasourceSelect,{datasourcePluginKind:d.nY,value:h,onChange:e=>{if((0,d.sv)(e)){a((0,u.Uy)(r,a=>{a.datasource=(0,d.Rv)(e)?void 0:e}));return}throw Error("Got unexpected non-Prometheus datasource selector")},labelId:"prom-datasource-label",label:"Prometheus Datasource",disabled:e.isReadonly})}),(0,l.jsx)(i.P,{completeConfig:{remote:{url:v}},value:r.expr,datasource:h,onBlur:a=>{e.onChange({...e.value,expr:a.target.textContent??""})},readOnly:e.isReadonly,width:"100%"}),(0,l.jsx)(s.Z,{label:"Label Name",value:e.value.labelName,InputProps:{readOnly:e.isReadonly},onChange:a=>{e.onChange({...e.value,labelName:a.target.value})}})]})}function y(e,a){let r=new Set;for(let l of e.result){let e=l.metric[a];void 0!==e&&r.add(e)}return Array.from(r.values())}function f(e,a){let r=new Set;for(let l of e.result){let e=l.metric[a];void 0!==e&&r.add(e)}return Array.from(r.values())}let C=e=>e?e.map(e=>({value:e,label:e})):[]}}]);